config {
    type: "table",

}

SELECT
  item,
  category,
  purchases,
  total_purchase,
  MAX(total_purchase) 
  OVER(PARTITION BY category ORDER BY total_purchase 
  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) 
  AS max_purchase
FROM
  ${ref("dep_cumsum")}
